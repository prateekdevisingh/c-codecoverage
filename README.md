# c-codecoverage

Step 1: Take Ubuntu machine
      prerequite :
        Test environment:

            *OS Ubuntu 18.04.1 LTS
            *GCC 7.3.0-16ubuntu3
            *GCOV and LCOV 1.x.x version
            
Step 2: Install all things with proper way, 

        $ apt install lcov
        $ apt install git
        $ apt install make
        $ apt install python
        
Step 3: Clone git repo ,

        $ git clone https://github.com/prateekdevisingh/c-codecoverage.git
        $ cd c-codecoverage/
        $ ls
        menu.cpp
        
Next lets start with compiling our code. Here my source file name is menu.cpp   

        $ g++ -o menu.out --coverage menu.cpp
        
The â€“coverage option here is used to compile and link code needed for coverage analysis. You will find a menu.gcno file in the folder. Next we need to export two variables namely GCOV_PREFIX and GCOV_PREFIX_STRIP. Set GCOV_PREFIX to the folder you want the output files to be in. 
Note : GCOV_PREFIX and GCOV_PREFIX_STRIP are important variable to export       
       
        $ ls
        menu.cpp  menu.out  menu.gcno      // you can see the new file menu.gcno
        
        $ mkdir gtest
        $ cd gtest
        $ pwd
        /root/gtest
        
For me , the project is in  "/root/gtest" and  inside this i have created a folder named gtest where i want the data files or .gcda file to be generated. so i set my GCOV_PREFIX to "/root/gtest" and the GCOV_PREFIX_STRIP equal to the the number of forward slashes or "/" in the path.        


        $ export GCOV_PREFIX="/root/gtest"
        $ export GCOV_PREFIX_STRIP=2
        
now lets simply run the code.
        
        $ ./menu.out
        MENU
            1: Add
            2: Subtract
            3: Multiply
            4: Divide
            5: Exit
            Enter your choice :2
            Enter two numbers: 3 4
            Difference -1
            MENU
            1: Add
            2: Subtract
            3: Multiply
            4: Divide
            5: Exit
            Enter your choice :5
 
 Note : Dont do CTRL + C on ubuntu , just choose 5 in Enter your choice: .
 Now we can see a menu.gcda file in data folder. Copy the .gcno file generated earlier to the data folder.
 
          $ ls
          menu.out menu.cpp menu.gcda menu.gcno
 
 Now that we have all the necessary files lets use lcov to read the coverage output file generated by gcov.
 
          $ lcov -t "result" -o ex_test.info -c -d .
    
 Here ex_test.info is my output file.

-t     sets a test name

-o    to specify the output file

-c    to capture the coverage data

-d    to specify the directory where the data files needs to be searched

Now we will generate out html output for the statistics.

         $ genhtml -o res ex_test.info
         
-o    To specify the output folder name.

Now on doing ls, you can see a folder named "res".

        $ ls
        menu.out menu.cpp menu.gcda menu.gcno res ex_test.info

Now its time to enjoy the fruits of your labor ðŸ˜› . Go into the res folder and start a server or you can simply open the index.html file in your web-browser.

        $ cd res
        $ python -m "SimpleHTTPServer"  //to start a web-server  or
        $ firefox index.html            //to open the index.html directly using firefox browser
        
                                 or
        $ cd res
        
look for index.html , simply open this file in any browser . and check image like i have stored in git repo , you already download.
     
 
    
  
